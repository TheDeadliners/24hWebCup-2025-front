{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/tepicharme/Developer/NextJS/webcup-2025-front/libs/actions/authentication.ts"],"sourcesContent":["\"use server\";\n\nimport {LoginData} from \"@/libs/schemas/login\";\nimport axios, {AxiosError, AxiosResponse} from \"axios\";\nimport {createSession, destroySession, getAuthenticationToken, JwtTokenData} from \"@/libs/actions/session\";\nimport {decodeJwt} from \"jose\";\nimport {AccountData} from \"@/libs/schemas/account\";\nimport {PasswordData} from \"@/libs/schemas/password\";\nimport {RegisterData} from \"@/libs/schemas/register\";\nimport {ForgotData} from \"@/libs/schemas/forgot\";\nimport {ResetData} from \"@/libs/schemas/reset\";\n\nconst BASE_URL = `${process.env.NEXT_PUBLIC_API_URL}/auth`;\n\nexport type AuthenticationResponse = {\n    code: string,\n    message: string\n}\n\nexport async function login(loginData: LoginData): Promise<AuthenticationResponse> {\n    try {\n        const loginResponse =  await axios.post(`${BASE_URL}/login`, loginData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            }\n        })\n\n        if (loginResponse.status === 200) {\n            await createSession(loginResponse.data.token);\n            return {\n                code: \"LOGIN_SUCCEED\",\n                message: \"Connexion établie !\"\n            }\n        } else {\n            return {\n                code: \"LOGIN_FAILED\",\n                message: loginResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.response?.status === 401) {\n            return {\n                code: \"LOGIN_FAILED\",\n                message: \"Identifiants invalides.\",\n            }\n        } else if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"LOGIN_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"LOGIN_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function forgot(forgotData: ForgotData): Promise<AuthenticationResponse> {\n    try {\n        const forgotResponse =  await axios.post(`${BASE_URL}/forgot-password`, forgotData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            }\n        })\n\n        if (forgotResponse.status === 200) {\n            return {\n                code: \"FORGOT_SUCCEED\",\n                message: forgotResponse.data.message\n            }\n        } else {\n            return {\n                code: \"FORGOT_FAILED\",\n                message: forgotResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"FORGOT_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"FORGOT_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function register(registerData: RegisterData): Promise<AuthenticationResponse> {\n    try {\n        const registerResponse =  await axios.post(`${BASE_URL}/register`, registerData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            }\n        })\n\n        if (registerResponse.status === 200) {\n            return {\n                code: \"REGISTER_SUCCEED\",\n                message: registerResponse.data.message\n            }\n        } else {\n            return {\n                code: \"REGISTER_FAILED\",\n                message: registerResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"REGISTER_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"REGISTER_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function reset(resetData: ResetData): Promise<AuthenticationResponse> {\n    try {\n        const registerResponse =  await axios.post(`${BASE_URL}/reset-password`, resetData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\"\n            }\n        })\n\n        if (registerResponse.status === 200) {\n            return {\n                code: \"RESET_SUCCEED\",\n                message: registerResponse.data.message\n            }\n        } else {\n            return {\n                code: \"RESET_FAILED\",\n                message: registerResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"RESET_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"RESET_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function refresh(): Promise<AuthenticationResponse> {\n    try {\n        const refreshResponse =  await axios.get(`${BASE_URL}/refresh`, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\",\n                \"Authorization\": `Bearer ${await getAuthenticationToken()}`\n            }\n        })\n\n        if (refreshResponse.status === 200) {\n            await createSession(refreshResponse.data.token);\n            const tokenData: JwtTokenData = decodeJwt(refreshResponse.data.token)\n            return {\n                code: \"REFRESH_SUCCEED\",\n                message: `Session actualisée pour ${tokenData.username} !`\n            }\n        } else {\n            return {\n                code: \"REFRESH_FAILED\",\n                message: refreshResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.response?.status === 401) {\n            return {\n                code: \"REFRESH_FAILED\",\n                message: \"Vous n'êtes pas connecté.\",\n            }\n        } else if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"REFRESH_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"REFRESH_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function logout(): Promise<void> {\n    await destroySession();\n}\n\nexport async function check(): Promise<boolean> {\n    const authSession = await getAuthenticationToken();\n    return authSession !== undefined;\n}\n\nexport async function password(passwordData: PasswordData): Promise<AuthenticationResponse> {\n    try {\n        const passwordResponse =  await axios.post(`${BASE_URL}/change-password`, passwordData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\",\n                \"Authorization\": `Bearer ${await getAuthenticationToken()}`\n            }\n        })\n\n        if (passwordResponse.status === 200) {\n            return {\n                code: \"REQUEST_SUCCEED\",\n                message: passwordResponse.data.message\n            }\n        } else {\n            return {\n                code: \"REQUEST_FAILED\",\n                message: passwordResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.response?.status === 401) {\n            return {\n                code: \"REQUEST_FAILED\",\n                message: \"Vous n'êtes pas connecté.\",\n            }\n        } else if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"REQUEST_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"REQUEST_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}\n\nexport async function account(accountData: AccountData): Promise<AuthenticationResponse> {\n    try {\n        const accountResponse =  await axios.post(`${BASE_URL}/edit-account`, accountData, {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"Accept\": \"application/json\",\n                \"Authorization\": `Bearer ${await getAuthenticationToken()}`\n            }\n        })\n\n        if (accountResponse.status === 200) {\n            return {\n                code: \"REQUEST_SUCCEED\",\n                message: accountResponse.data.message\n            }\n        } else {\n            return {\n                code: \"REQUEST_FAILED\",\n                message: accountResponse.data.message\n            }\n        }\n    } catch (error) {\n        const axiosError = error as AxiosError;\n        if (axiosError.response?.status === 401) {\n            return {\n                code: \"REQUEST_FAILED\",\n                message: \"Vous n'êtes pas connecté.\",\n            }\n        } else if (axiosError.code == \"ECONNREFUSED\") {\n            return {\n                code: \"REQUEST_ERROR\",\n                message: `Erreur : L'API est injoignable.`\n            }\n        } else {\n            const responseError = axiosError.response as AxiosResponse;\n            return {\n                code: \"REQUEST_ERROR\",\n                message: `Erreur : ${responseError.data?.message ?? axiosError.code}`\n            }\n        }\n    }\n}"],"names":[],"mappings":";;;;;;IA0NsB,SAAA,WAAA,GAAA,CAAA,GAAA,sNAAA,CAAA,wBAAA,EAAA,8CAAA,sNAAA,CAAA,aAAA,EAAA,KAAA,GAAA,sNAAA,CAAA,mBAAA,EAAA","debugId":null}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///Users/tepicharme/Developer/NextJS/webcup-2025-front/components/controls/backoffice/logout-modal.tsx"],"sourcesContent":["\"use client\";\n\nimport {useState} from \"react\";\nimport {logout} from \"@/libs/actions/authentication\";\nimport {DoorIcon, SpinnerIcon} from \"@phosphor-icons/react\";\nimport {UserData} from \"@/libs/actions/session\";\n\nexport default function LogoutModal({userData}: {userData: UserData}) {\n    const [isModalOpenState, setIsModalOpenState] = useState<boolean>(false);\n    const [isLoggingOutState, setIsLoggingOutState] = useState<boolean>(false);\n\n    const openLogoutModal = () => {\n        setIsModalOpenState(true);\n    }\n\n    const closeLogoutModal = () => {\n        setIsModalOpenState(false);\n    }\n\n    const logoutFromApplication = async () => {\n        setIsLoggingOutState(true);\n        await logout();\n    }\n\n    return (\n        <>\n            <button type=\"button\" className=\"btn btn-neutral\" onClick={openLogoutModal}>\n                <DoorIcon weight=\"bold\" className=\"h-6 w-6\" /> <span className=\"hidden md:flex\">Déconnexion</span>\n            </button>\n            <dialog className={`modal ${isModalOpenState ? \"modal-open\" : null}`}>\n                <div className=\"modal-box text-center\">\n                    <h3 className=\"font-bold text-lg\">Déconnexion de l&apos;application</h3>\n                    <p className=\"py-4\">Voulez-vous vous déconnecter ?</p>\n                    <div>\n                        <div className=\"badge badge-success\">{userData.username}</div>\n                    </div>\n                    <div className=\"modal-action justify-between\">\n                        <button type=\"button\" className=\"btn btn-neutral\" onClick={closeLogoutModal}>Annuler</button>\n                        <button type=\"button\" className=\"btn btn-error\" onClick={logoutFromApplication} disabled={isLoggingOutState}>\n                            {!isLoggingOutState ? \"Confirmer\" : <><SpinnerIcon className=\"icon animate-spin\"/></>}\n                        </button>\n                    </div>\n                </div>\n            </dialog>\n        </>\n    );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAAA;AAJA;;;;;AAOe,SAAS,YAAY,EAAC,QAAQ,EAAuB;IAChE,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAW;IAClE,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAW;IAEpE,MAAM,kBAAkB;QACpB,oBAAoB;IACxB;IAEA,MAAM,mBAAmB;QACrB,oBAAoB;IACxB;IAEA,MAAM,wBAAwB;QAC1B,qBAAqB;QACrB,MAAM,CAAA,GAAA,uJAAA,CAAA,SAAM,AAAD;IACf;IAEA,qBACI;;0BACI,8OAAC;gBAAO,MAAK;gBAAS,WAAU;gBAAkB,SAAS;;kCACvD,8OAAC,yKAAA,CAAA,WAAQ;wBAAC,QAAO;wBAAO,WAAU;;;;;;oBAAY;kCAAC,8OAAC;wBAAK,WAAU;kCAAiB;;;;;;;;;;;;0BAEpF,8OAAC;gBAAO,WAAW,CAAC,MAAM,EAAE,mBAAmB,eAAe,MAAM;0BAChE,cAAA,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAG,WAAU;sCAAoB;;;;;;sCAClC,8OAAC;4BAAE,WAAU;sCAAO;;;;;;sCACpB,8OAAC;sCACG,cAAA,8OAAC;gCAAI,WAAU;0CAAuB,SAAS,QAAQ;;;;;;;;;;;sCAE3D,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAO,MAAK;oCAAS,WAAU;oCAAkB,SAAS;8CAAkB;;;;;;8CAC7E,8OAAC;oCAAO,MAAK;oCAAS,WAAU;oCAAgB,SAAS;oCAAuB,UAAU;8CACrF,CAAC,oBAAoB,4BAAc;kDAAE,cAAA,8OAAC,4KAAA,CAAA,cAAW;4CAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOzF","debugId":null}}]
}